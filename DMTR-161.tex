\documentclass[DM,lsstdraft,STR,toc]{lsstdoc}
\usepackage{geometry}
\usepackage{longtable,booktabs}
\usepackage{enumitem}
\usepackage{arydshln}

\input meta.tex

\providecommand{\tightlist}{
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}

\def\milestoneName{LSP with Authentication and TAP}
\def\milestoneId{LDM-503-10a:}
\def\product{LSP Services}

\setDocCompact{true}

\title{ LDM-503-10a: LSP with Authentication and TAP Test Plan and Report}
\setDocRef{\lsstDocType-\lsstDocNum}
\date{\vcsdate}
\setDocUpstreamLocation{\url{https://github.com/lsst/lsst-texmf/examples}}
\author{ Gregory Dubois-Felsmann }

\input history_and_info.tex


\setDocAbstract{
This is the test plan and report for LDM-503-10a: (LSP with Authentication and TAP), an LSST level 2 milestone pertaining to the Data Management Subsystem.
}


\maketitle

\section{Introduction}
\label{sect:intro}


\subsection{Objectives}
\label{sect:objectives}

Verify the integration of federated authentication and authorization
into the LSST science platform, and the availability of an IVOA TAP
service.\\
~\\
\textbf{Milestone Description}\\
~\\
This test demonstrates the successful integration of a single-sign-on
federated authentication system, and a basic authorization system, with
the three Aspects of the LSST Science Platform (Portal, Notebook, and
API), with the API Aspect containing at least a TAP service. ~It will be
demonstrated on a Kubernetes cluster provided by NCSA. ~It is not
required for authorization to be applied at the database level; it is
sufficient for this milestone for it to apply only at the TAP level.
~Data served will remain that from the original PDAC work, i.e., SDSS
Stripe 82 and/or WISE.\\
~\\

\hypertarget{scope}{%
\subsection{Scope}\label{scope}}

The overall strategy for testing and verification within LSST Data
Management is described in \citeds{LDM-503}.\\
This test plan specifically verifies successful completion of milestone
LDM-503-10a.



\subsection{System Overview}
\label{sect:systemoverview}

The LSST Science Platform (see \citeds{LSE-319}, \citeds{LDM-554}, and \citeds{LDM-542}) is the
means of access for science users to the LSST data. ~It also serves
project-internal users for a wide variety of data access needs during
construction (using prototypes and early versions), commissioning, and
operations.


\subsection{Document Overview}
\label{sect:docoverview}

This document was generated from Jira, obtaining the relevant information from the 
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testPlan/LVV-P48}{LVV-P48}
~Jira Test Plan and related Test Cycles (
  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCycle/LVV-C85}{LVV-C85}
).

Section \ref{sect:intro} provides an overview of the test campaign, the system under test (\product{}), the applicable documentation, and explains how this document is organized.
Section \ref{sect:configuration}  describes the configuration used for this test.
Section \ref{sect:personnel} describes the necessary roles and lists the individuals assigned to them.
%Section \ref{sect:plannedtestactivities} provides the list of planned test cycles and test cases, including all relevant information that fully describes the test campaign.

Section \ref{sect:overview} provides a summary of the test results, including an overview in Table \ref{table:summary}, an overall assessment statement and suggestions for possible improvements.
Section \ref{sect:detailedtestresults} provides detailed results for each step in each test case.

The current status of test plan LVV-P48 in Jira is \textbf{ Approved }.

\subsection{References}
\label{sect:references}
\renewcommand{\refname}{}
\bibliography{lsst,refs,books,refs_ads}
\section{Test Configuration}
\label{sect:configuration}

\subsection{Data Collection}

  Observing is not required for this test campaign.

\subsection{Verification Environment}
\label{sect:hwconf}
  The "lsst-lsp-stable" instance of the LSP, hosted at the LDF.





\newpage
\section{Personnel}
\label{sect:personnel}

The personnel involved in the test campaign is shown in the following table.

\begin{longtable}{p{3cm}p{3cm}p{3cm}p{6cm}}
\hline
\multicolumn{2}{r}{Test Plan (LVV-P48) owner:} &
\multicolumn{2}{l}{\textbf{ Gregory Dubois-Felsmann } }\\\hline
\multicolumn{2}{r}{ LVV-C85 owner:} &
\multicolumn{2}{l}{\textbf{
    Gregory Dubois-Felsmann
}
} \\\hline
\textbf{Test Case} & \textbf{Assigned to} & \textbf{Executed by} & \textbf{Additional Test Personnel} \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T807}{LVV-T807}
& {\small Jeffrey Carlin } & {\small Gregory Dubois-Felsmann } &
{\small  } \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T622}{LVV-T622}
& {\small Jeffrey Carlin } & {\small Gregory Dubois-Felsmann } &
{\small  } \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1334}{LVV-T1334}
& {\small Gregory Dubois-Felsmann } & {\small Gregory Dubois-Felsmann } &
{\small  } \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1436}{LVV-T1436}
& {\small Gregory Dubois-Felsmann } & {\small  } &
{\small  } \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1437}{LVV-T1437}
& {\small Gregory Dubois-Felsmann } & {\small  } &
{\small  } \\ \hline
\end{longtable}

\newpage

\section{Overview of the Test Results}
\label{sect:overview}

\subsection{Summary}
\label{sect:summarytable}

\begin{longtable}{p{0.12\textwidth}p{0.2\textwidth}p{0.56\textwidth}p{0.12\textwidth}}
\toprule

  \multicolumn{3}{c}{ Test Cycle {\bf LVV-C85: LDM-503-10a: LSP with Authentication and TAP
 }} \\\hline

  {\bf \footnotesize test case} & {\bf \footnotesize status} & {\bf \footnotesize comment} & {\bf \footnotesize issues} \\\toprule

    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T807}{LVV-T807}
    & Pass &
    \begin{minipage}[]{0.56\textwidth}
    \smallskip
    Test executed against lsst-lsp-int. ~No problems were encountered.\\
Test executed from an OS X 10.11 iMac on the IPAC internal network, with
pre-arranged VPN-free access to the relevant NCSA network.

    \medskip
    \end{minipage}
    &     \\\hline
    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T622}{LVV-T622}
    & Pass w/ Deviation &
    \begin{minipage}[]{0.56\textwidth}
    \smallskip
    Test executed against lsst-lsp-int. ~\\
Test executed from an OS X 10.11 iMac on the IPAC internal network, with
pre-arranged VPN-free access to the relevant NCSA network.

    \medskip
    \end{minipage}
    &     \\\hline
    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1334}{LVV-T1334}
    & Pass w/ Deviation &
    \begin{minipage}[]{0.56\textwidth}
    \smallskip
    Executed with Firefox 70.0.1 on OS X 10.11.6, from a host on the IPAC
internal network with VPN-free access to the LSP clusters at NCSA.

    \medskip
    \end{minipage}
    &     \\\hline
    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1436}{LVV-T1436}
    & Not Executed &
    \begin{minipage}[]{0.56\textwidth}
    \smallskip
    
    \medskip
    \end{minipage}
    &     \\\hline
    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1437}{LVV-T1437}
    & Not Executed &
    \begin{minipage}[]{0.56\textwidth}
    \smallskip
    
    \medskip
    \end{minipage}
    &     \\\hline

\caption{Test Results Summary}
\label{table:summary}
\end{longtable}

\subsection{Overall Assessment}
\label{sect:overallassessment}

Not yet available.

\subsection{Recommended Improvements}
\label{sect:recommendations}

Not yet available.

\newpage
\section{Detailed Test Results}
\label{sect:detailedtestresults}


  \subsection{Test Cycle LVV-C85 }

Open test cycle {\it \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testrun/LVV-C85}{LDM-503-10a: LSP with Authentication and TAP
}} in Jira.

  LDM-503-10a: LSP with Authentication and TAP
\\
  Status: In Progress

  Execute the test cases associated with the DM milestone LDM-503-10a.


  \subsubsection{Software Version/Baseline}
    Not provided.

  \subsubsection{Configuration}
    Not provided.

  \subsubsection{Test Cases in LVV-C85 Test Cycle}


    \paragraph{Test Case LVV-T807 - Verify synchronous TAP queries
 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T807}{\textit{ LVV-T807 } }
test case in Jira.

    Verify that the API Aspect TAP endpoint supports synchronous queries as
described by the IVOA TAP 1.1 specification. ~ ~


    \textbf{ Preconditions}:\\
    

    Execution status: {\bf Pass }

    Final comment:\\Test executed against lsst-lsp-int. ~No problems were encountered.\\
Test executed from an OS X 10.11 iMac on the IPAC internal network, with
pre-arranged VPN-free access to the relevant NCSA network.



    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Using a Web browser, navigate to the\\
"/auth/tokens" endpoint of the LSP instance under test.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A credential-entry screen should be displayed, unless the test user is
already logged in in another window or tab of the browser.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The general CILogon login screen appeared.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      If necessary, enter a valid set of credentials. ~They may be NCSA or
non-NCSA credentials.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The token-request UI is displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      NCSA credentials were used, with a Duo push. ~Successful; reached
"Personal access tokens" screen.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Request a token for the "read:tap" capability.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A screen confirming the creation of the token.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      "Generate new token" selected. ~"read:tap" selected.\\
A token oauth2\_proxy-a77...6b9b generated, expiring in 24 hours.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      4 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Leave the resulting page's browser tab/window open for use in subsequent
test steps.\\
~\\
In many cases you may be asked in a subsequent step to use the "copy
token to clipboard" UI element on this page in order to transfer your
token to a prompt in another window.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      (n/a)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      5 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      From a Unix prompt on a system with network access to the TAP service in
the LSP instance under test, and a "bash"-style shell, verify using the
"export" and "curl" commands below that an attempt to access the TAP
service with the token from the previous step is successful.\\
~\\
Replace "lsst-lsp-int.ncsa.illinois.edu" in the "curl" command with the
appropriate root URL for the LSP instance under test.\\
~\\
Use the "copy to clipboard" function from the token-access page from the
previous step to paste the token into the (blind) prompt that results
from the "read" command.\\
~\\
Ensure that the token is deleted from the test environment after the
"curl" command is complete, and that the token is invalidated via the
token-access web interface.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The "curl" command returned HTTP status code 200, in a total time
1.081s, returning 8391 bytes with Content-Type
"application/x-votable+xml". ~The file tap-tables.xml was created and is
attached to this execution.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      6 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Verify by inspection that the file resulting from the "curl" command
above has the general form of a VOTable. ~(A separate test case will
verify the VOTable format itself.)\\
~\\
Save this file as part of the test records using LSST standard
procedures.~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The tap-tables.xml file does appear to the eye to be a reasonably
conformant VOTable 1.3 file with a TABLEDATA payload.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

    \end{longtable}


    \paragraph{Test Case LVV-T622 - Verify LSP only available to authenticated users
 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T622}{\textit{ LVV-T622 } }
test case in Jira.

    Verify that the functions and services of all three aspects of the LSP
are accessible only to authenticated users.


    \textbf{ Preconditions}:\\
    

    Execution status: {\bf Pass w/ Deviation }

    Final comment:\\Test executed against lsst-lsp-int. ~\\
Test executed from an OS X 10.11 iMac on the IPAC internal network, with
pre-arranged VPN-free access to the relevant NCSA network.



    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Attempt to navigate to the Portal Aspect of the LSP instance under test.
~Verify that credentials are requested and that a Portal interface is
not displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      No direct access to Portal; credential request screen displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Confirmed; CILogon with an LSST facade was reached.\\
"\href{https://lsst-lsp-int.ncsa.illinois.edu/}{LSST LSP Integration
(Domain Ingress Client)} requests access to the following information.
If you do not approve this request, do not proceed."

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Enter the (presumably invalid) credentials user=foo, password=xyzzy, and
verify that access to the Portal Aspect interface is not granted.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      No access to Portal Aspect; credential request screen displayed again.
~Record any error message that is shown.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The message "The username you entered cannot be identified." was
displayed in a colored box on the CILogon login screen. ~This is worth
further investigation, to see whether this allows external actors to
deduce valid userids.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

        & Issues        &
        \begin{minipage}[t]{13cm}{\footnotesize
          \href{https://jira.lsstcorp.org/browse/DM-22338}{DM-22338}~~CILogon can be used to check whether an NCSA username is valid; is this
OK?

        \vspace{\dp0}
        } \end{minipage} \\
        \\ \cdashline{2-3}

      & Status          & Pass \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Enter a set of valid credentials, and verify that access to the Portal
interface is granted.\\
~\\
This test does not involve any exploration of the Portal behavior at
this point.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      Access to some version of the Portal interface is granted. ~(The exact
nature of that interface will be evolving in the course of LSST
construction and system integration.)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The "TAP Searches" screen of the Portal application appeared by default.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      4 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Log out from the Portal.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A logout or LSP landing page is displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      A screen with just a "Sign in with OpenID Connect" button (and a footer
reading "Secured with
\href{https://github.com/pusher/oauth2_proxy\#oauth2_proxy}{OAuth2
Proxy} version v3.2.0-151-g151ec7b") appeared.\\
~\\
This is not entirely acceptable in the long run. ~The user should never
lose sight of a screen that confirms that they are still in an LSST
environment. ~It is also not clear to what authentication domain one
would be signing in, or what screen one would reach if signing in were
successful.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

        & Issues        &
        \begin{minipage}[t]{13cm}{\footnotesize
          \href{https://jira.lsstcorp.org/browse/DM-22350}{DM-22350}~~"Logout" buttons in Portal and Notebook Aspects: non-user-friendly
result, and apparently incomplete logout

        \vspace{\dp0}
        } \end{minipage} \\
        \\ \cdashline{2-3}

      & Status          & Initial Pass \\ \hline

      5 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Attempt to navigate to the Notebook Aspect of the LSP instance under
test. ~Verify that credentials are requested and that no other Notebook
Aspect functionality is exposed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      No direct access to the Notebook Aspect; credential request screen
displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Manual navigation back to the main instance landing page was required.
~No link to do this was available from the screen displayed in Step 4.\\
Once at the landing page, clicking on the "Notebook Aspect" link
produced a fresh CILogon login screen.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      6 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Enter the (presumably invalid) credentials user=foo, password=xyzzy, and
verify that access to the Notebook Aspect interface is not granted.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      No access to Notebook Aspect; credential request screen displayed again.
~Record any error message that is shown.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      After pressing the "Log On" button on the initial CILogon screen, it
became clear that I had not in fact been fully logged out. ~No
username/password screen was displayed at all, and I ended up on the
"Start My Server" page of JupyterHub, with my userid displayed and a
"Logout" button. ~Clicking that "Logout" button was no more successful
at actually logging me out than the Portal equivalent was.\\
~\\
Conditional pass because the security vulnerability here only seriously
affects shared-browser situations.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass w/ Deviation \\ \hline

      7 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Enter a set of valid credentials, and verify that access to the Notebook
Aspect interface is granted.\\
~\\
This test does not involve any exploration of the Notebook Aspect
behavior at this point.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      An initial page of the JupyterHub system is displayed. ~Note briefly
what is seen, but no further testing is required.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      This step also could not be executed, as it proved impossible to get the
system into a state in which credentials were requested.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass w/ Deviation \\ \hline

      8 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Log out of the Notebook Aspect.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      This had the same result as in Step 4.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Initial Pass \\ \hline

      9 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      From a Unix prompt on a system with network access to the TAP service in
the LSP instance under test, verify using the "curl" command below that
an attempt to access the TAP service without credentials is rejected.~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      (Step 9 appears to have been an incomplete duplicate of Step 10.
~Skipped.)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      10 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      From a Unix prompt on a system with network access to the TAP service in
the LSP instance under test, verify using the "curl" command below that
an attempt to access the TAP service with invalid credentials is
rejected.\\
~\\
Replace "lsst-lsp-int.ncsa.illinois.edu" in the "curl" command with the
appropriate root URL for the LSP instance under test.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      HTTP status code 401 (Authorization Required) was received. ~The HTML
code attached as "tap-noauth.html" was returned.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      11 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Using a web browser, navigate to the token-access endpoint
(/auth/tokens) of the LSP instance under test. ~Authenticate with valid
LSST credentials. ~Obtain a token for the "read:tap" capability. ~Leave
the resulting web page displayed. ~It is not necessary to expose the
full token text.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A token is granted.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Token ID oauth2\_proxy-c077...00f8 was received, with a 24 hour
lifetime.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      12 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      From a Unix prompt on a system with network access to the TAP service in
the LSP instance under test, and a "bash"-style shell, verify using the
"export" and "curl" commands below that an attempt to access the TAP
service with the token from the previous step is successful.\\
~\\
Replace "lsst-lsp-int.ncsa.illinois.edu" in the "curl" command with the
appropriate root URL for the LSP instance under test.\\
~\\
Use the "copy to clipboard" function from the token-access page from the
previous step to paste the token into the (blind) prompt that results
from the first "export" command.\\
~\\
Ensure that the token is deleted from the test environment after the
"curl" command is complete, and that the token is invalidated via the
token-access web interface.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The "curl" command should return HTTP status code 200 and a VOTable
containing a list of tables in the TAP service should be obtained.\\
~\\
Retain the VOTable file in the test records.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The test was successful.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

    \end{longtable}


    \paragraph{Test Case LVV-T1334 - LDM-503-10a: Portal Aspect tests for LSP with Authentication and TAP
milestone
 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1334}{\textit{ LVV-T1334 } }
test case in Jira.

    This test case verifies that the Portal Aspect of the Science Platform
is accessible to authorized users through a login process, and that TAP
searches can be performed from the Portal Aspect UI.\\
~\\
In so doing and in conjunction with the other LDM-503-10a test cases
collected under LVV-P48, it addresses all or part of the following
requirements:

\begin{itemize}
\tightlist
\item
  DMS-LSP-REQ-0002, DMS-LSP-REQ-0005, DMS-LSP-REQ-0006,
  DMS-LSP-REQ-0020, DMS-LSP-REQ-0022, DMS-LSP-REQ-0023, DMS-LSP-REQ-0024
\item
  DMS-PRTL-REQ-0001, DMS-PRTL-REQ-0015, DMS-PRTL-REQ-0016,
  DMS-PRTL-REQ-0017, DMS-PRTL-REQ-0020, DMS-PRTL-REQ-0026,
  DMS-PRTL-REQ-0049, and DMS-PRTL-REQ-0095, primarily
\end{itemize}

Note this test was not designed to perform a full verification of the
above requirements, but rather to demonstrate having reached a certain
level of partial capability during construction.


    \textbf{ Preconditions}:\\
    

    Execution status: {\bf Pass w/ Deviation }

    Final comment:\\Executed with Firefox 70.0.1 on OS X 10.11.6, from a host on the IPAC
internal network with VPN-free access to the LSP clusters at NCSA.



    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Navigate to the \url{https://lsst-lsp-stable.ncsa.illinois.edu/}
endpoint of the LSP at the LDF. ~From the displayed page, navigate to
the Portal Aspect.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A login screen should be displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Test performed on https://lsst-lsp-int.ncsa.illinois.edu/\\
~\\
Login screen displayed as expected.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Log in to the Portal Aspect with NCSA credentials. ~Verify that a Portal
TAP search screen comes up. ~Note the user name displayed in the upper
left of the Portal. ~Log out.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      Following login, the Portal Aspect TAP search screen should be
displayed, or a clearly visible UI element allowing one-click access to
that screen. ~A user name corresponding to the credentials entered
should be displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      TAP search screen displayed upon login. ~Username "Gregory
Dubois-Felsmann" displayed.\\
~\\
Logging out resulted in the "Sign in with OpenID Connect" button being
displayed. ~See DM-22350 for an issue regarding that result.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

        & Issues        &
        \begin{minipage}[t]{13cm}{\footnotesize
          \href{https://jira.lsstcorp.org/browse/DM-22350}{DM-22350}~~"Logout" buttons in Portal and Notebook Aspects: non-user-friendly
result, and apparently incomplete logout

        \vspace{\dp0}
        } \end{minipage} \\
        \\ \cdashline{2-3}

      & Status          & Pass \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Log in to the Portal Aspect with alternate credentials that are
associated with the same identity. ~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The Portal application should come up just as in the previous step; the
user name displayed in the upper left of the Portal should be the same
as in the previous step.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Because of the logout issues in DM-22350, before carrying out this step
I cleared my browser history to ensure no carryover of old
credentials/tokens/authorization headers.\\
~\\
Logging in with Caltech credentials that had been associated with my
NCSA account via identity.lsst.org, I reached the same Portal screen
with "Gregory Dubois-Felsmann" displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      4 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Navigate to the TAP search screen, if necessary, and ensure that the
LSST TAP service associated with the chosen LSP instance is selected.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A TAP search screen should either already be displayed after the
previous step, or should be displayed after a one-click action from the
Portal's initial page. ~On the TAP screen, a UI element allowing the
choice of TAP service to user should be available, and an LSST TAP
service associated with the LSP instance under test should be
pre-selected as the default.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The lsst-lsp-int.ncsa.illinois.edu/api/tap service was, correctly,
selected by default.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      5 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Verify that the same WISE and SDSS catalog tables that were explored in
DMTR-52 are now visible in the TAP service.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The SDSS Stripe 82 2013 processing's deep detection and forced
photometry catalogs, and the WISE mission's principal catalog, forced
photometry catalog, and single-epoch source catalog should be
accessible.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The SDSS "RunDeepSource" (deep detection) and "RunDeepForcedSource"
(forced photometry) tables are available, under the "sdss\_stripe82\_01"
schema (along with a number of additional tables from the original
deployment).\\
~\\
The WISE "allwise\_p3as\_psd" (deep detection) and "allwise\_p3as\_mep"
(forced photometry) tables are available, under the "wise\_00" schema
(along with a number of additional tables from the original deployment).
The three single-epoch source photometry tables do not seem to be
visible.\\
~\\
While this is not formally a deviation from the test plan as written,
these tables are all missing explanatory text in the TAP\_SCHEMA
metadata used by the Portal TAP interface, so there is no user-friendly
way to determine the meaning of the tables available to query.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

        & Issues        &
        \begin{minipage}[t]{13cm}{\footnotesize
          \href{https://jira.lsstcorp.org/browse/DM-22421}{DM-22421}~~Investigate why the WISE single-epoch photometry tables are not visible
in the lsst-lsp-int TAP service

          \href{https://jira.lsstcorp.org/browse/DM-22422}{DM-22422}~~Provide metadata for the SDSS and WISE schema and table data in
TAP\_SCHEMA

        \vspace{\dp0}
        } \end{minipage} \\
        \\ \cdashline{2-3}

      & Status          & Pass w/ Deviation \\ \hline

      6 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Perform a TAP search on the AllWISE source catalog around the equatorial
coordinates (2, 0) (degrees), with a 30 arcminute radius, using the
Portal UI to specify the query (select the "Single Table" radio button).
~\\
To find the AllWISE source catalog, select the "wise\_00" schema from
the schema menu, and then the "wise\_00.allwise\_p3as\_psd" table from
the table menu.\\
When the query completes, note the total number of rows in the table, as
displayed in the table header, and record it.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      This query should return about 12,000 rows of data. ~It should be
displayed in a table, as an overlay on a context image, and as a
configurable 2D density plot.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      A table of 12,717 rows was retrieved. ~The data were displayed as a
table of 128 100-row pages (that default page size is configurable, and
can be changed on the fly by the user). ~They were also displayed as an
overlay on a 2MASS color HiPS image, and as an x-y density plot, with
the axes (ra,decl) selected by default, but easily changed in the UI.\\
~\\
The test runner issued the query requesting the following columns (which
should have been called out in the test specification): ra, decl, cntr,
source\_id, coadd\_id, w1mpro, w2mpro, w3mpro, w4mpro.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      7 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Using the table viewer UI, save the result of this search as a text file
in CSV format. ~Use a line-counting tool to find the number of rows in
the result, record it, and compare it with the reported number from the
previous step. ~Ensure that the CSV file's name is
"LVV-T1334-output.csv" and save it to the designated repository for test
outputs.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      Allowing for the CSV header row, the number of ~rows in the file should
match the number of rows in the table header in the UI.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      \% wc LVV-T1334-output.csv\\
12718 12718 1567903 LVV-T1334-output.csv\\
\% head -2 LVV-T1334-output.csv\\
cntr,coadd\_id,decl,ra,source\_id,w1mpro,w2mpro,w3mpro,w4mpro\\
15100001351031627,0015p000\_ac51,-0.07016340,1.54437160,0015p000\_ac51-031627,16.36700000,15.81700000,12.21100000,8.40600000\\
~\\
12,718 rows in the file is the expectation from Step 6: 12,717 plus one
header row.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      8 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Return to the TAP search screen in the UI (this can be done with the
"TAP Searches" button near the top of the window), select the "ADQL"
radio button, and view and record the ADQL text displayed for the query
performed. ~Select "Cancel" to dismiss the search screen.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The query should appear to have the expected form for an ADQL cone
search, using the CONTAINS() and CIRCLE() functions.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      The button is labeled "LSST TAP", not "TAP Searches".\\
~\\
The ADQL text is:\\
SELECT cntr,coadd\_id,decl,ra,source\_id,w1mpro,w2mpro,w3mpro,w4mpro
FROM wise\_00.allwise\_p3as\_psd WHERE CONTAINS(POINT('ICRS', ra,
decl),CIRCLE('ICRS', 2, 0, 0.5))=1

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      9 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Select the "i"-in-a-circle button in the table header. ~In the resulting
dialog box, click on the copy-to-clipboard icon for the TAP job URL for
the query and paste the URL into the test record.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      https://lsst-lsp-int.ncsa.illinois.edu/api/tap/async/eatzseuepds92ous

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

      10 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      In a separate browser window, access the page available at the URL
obtained from the previous step. ~Observe and record the ADQL text for
the query, in the '\textless{}uws:parameter id="query"\textgreater{}'
XML element. ~Verify that it matches the ADQL text obtained from the UI
in a previous step.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The ADQL code matches that from Step 8.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      Pass:\\
\textless{}uws:parameter id="QUERY"\textgreater{}\\
SELECT cntr,coadd\_id,decl,ra,source\_id,w1mpro,w2mpro,w3mpro,w4mpro
FROM wise\_00.allwise\_p3as\_psd WHERE CONTAINS(POINT('ICRS', ra,
decl),CIRCLE('ICRS', 2, 0, 0.5))=1\\
\textless{}/uws:parameter\textgreater{}

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Pass \\ \hline

    \end{longtable}


    \paragraph{Test Case LVV-T1436 - LDM-503-10a: Notebook Aspect tests for LSP with Authentication and TAP
milestone
 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1436}{\textit{ LVV-T1436 } }
test case in Jira.

    This test case verifies that the Notebook Aspect of the Science Platform
is accessible to authorized users through a login process, and that TAP
searches can be performed from Python code in the Notebook Aspect.\\
~\\
In so doing and in conjunction with the other LDM-503-10a test cases
collected under LVV-P48, it addresses all or part of the following
requirements:

\begin{itemize}
\tightlist
\item
  DMS-LSP-REQ-0003, DMS-LSP-REQ-0005, DMS-LSP-REQ-0006,
  DMS-LSP-REQ-0020, DMS-LSP-REQ-0022, DMS-LSP-REQ-0023, DMS-LSP-REQ-0024
\item
  DMS-NB-REQ-0001, DMS-NB-REQ-0002, DMS-NB-REQ-0005, DMS-NB-REQ-0006,
  DMS-NB-REQ-0013, DMS-NB-REQ-0017, and DMS-NB-REQ-0029, primarily
\end{itemize}

Note this test was not designed to perform a full verification of the
above requirements, but rather to demonstrate having reached a certain
level of partial capability during construction.


    \textbf{ Preconditions}:\\
    Test case LVV-T1334 must have already been executed and the prescribed
outputs saved, notably including the "LVV-T1334-output.csv" file.


    Execution status: {\bf Not Executed }

    Final comment:\\


    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      If~\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1334}{LVV-T1334
(1.0)} has just been carried out, the tester will already be logged in
to the Portal Aspect; skip to the next step.\\
~\\
Otherwise, use a Web browser to navigate to the landing page of the LSP
instance under test, and click through to the Portal Aspect link. ~This
should trigger a login process; the tester should log in. ~Non-NCSA
credentials should be used (or have been used) to log in to the Portal
Aspect.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The web browser should display a Portal Aspect page with the user's name
noted in the upper right hand corner.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Use the same Web browser (in a new page or tab) to navigate to the
landing page of the LSP instance under test, and click through to the
Notebook Aspect link. ~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      No login credentials should be requested. ~A page allowing the creation
of a Notebook Aspect session should be visible.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Use the Notebook Aspect UI to create a "small" session using the most
recent "recommended" (weekly) release image.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The main JupyterLab UI should appear.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      4 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Close any Portal Aspect window/tab(s) that are open.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      5 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Use the JupyterLab Terminal application to create a small file in the
user's home directory.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The test file should be visible in the JupyterLab file browser.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      6 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Log out of the Notebook Aspect. ~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      7 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Navigate to the landing page for the LSP instance under test. ~Navigate
to the Portal Aspect from that page. ~(Do not log in if a login is
requested.)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      A login should be requested when the Portal Aspect is accessed. ~(This
verifies that \emph{logout} is cross-Aspect.)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      8 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Close the login window and quit the web browser in use.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      9 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Launch a web browser and navigate to the landing page for the LSP
instance under test. ~Navigate to the Notebook Aspect. ~When prompted
for a login, use NCSA credentials (for the same user as the non-NCSA
credentials used above). ~Request a session of the "medium" category
with the most recent "recommended" (weekly) release image.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The usual JupyterLab UI should be displayed.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      10 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Examine the JupyterLab file browser for the file created in \textbf{Step
5} above. ~If convenient (e.g., based on other distinctive files or
persistent settings), verify further that the same user environment has
been reached as with the non-NCSA credentials above.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      The same file should be visible. ~(This verifies that the two sets of
credentials lead to the same Notebook Aspect user environment.)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      11 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Clone the test notebook for LDM-503-10a, "LDM-503-10a-test.ipynb", into
the user environment from the TBD tag of the TBD Github repository.
~Record the SHA that applies to the version of the test notebook that
has been cloned.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      12 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Open the test notebook and insert the URL saved from the execution of
LVV-T1334, Step 9 into the input cell that reads\\
"portal\_job\_url = ''".

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      13 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Record the success and/or failure indications that appear in the final
output cell of the notebook.\\
If the notebook execution produced an exception, record that.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      14 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Save and close the test notebook. ~Save the fully-executed notebook in
TBD location as a record of the test.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      15 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Without logging out, open a new browser window or tab, and navigate to
the Portal Aspect of the LSP instance under test. ~Verify that the
Portal Aspect can be accessed without a further login. ~Verify that the
username displayed at the upper right is the same one as in \textbf{Step
1} above.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      16 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Log out of the Notebook Aspect, close the Portal Aspect windows, and
quit the Web browser in use.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      17 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Copy the file "LVV-T1334-output.csv" that was saved in the output
repository for the LVV-T1334 test case into the home directory of the
notebook session.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      18 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Execute the entire notebook.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

    \end{longtable}


    \paragraph{Test Case LVV-T1437 - LDM-503-10a: API Aspect tests for LSP with Authentication and TAP
milestone
 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1437}{\textit{ LVV-T1437 } }
test case in Jira.

    This test case verifies that the TAP service in the API Aspect of the
Science Platform is accessible to authorized users through a login
process, and that TAP searches can be performed using the IVOA TAP
protocol from remote sites.\\
~\\
In so doing and in conjunction with the other LDM-503-10a test cases
collected under LVV-P48, it addresses all or part of the following
requirements:

\begin{itemize}
\tightlist
\item
  DMS-LSP-REQ-0004, DMS-LSP-REQ-0005, DMS-LSP-REQ-0006,
  DMS-LSP-REQ-0020, DMS-LSP-REQ-0022, DMS-LSP-REQ-0023, DMS-LSP-REQ-0024
\item
  DMS-API-REQ-0003, DMS-API-REQ-0004, DMS-API-REQ-0006,
  DMS-API-REQ-0007, DMS-API-REQ-0008, DMS-API-REQ-0009,
  DMS-API-REQ-0023, and DMS-API-REQ-0039, primarily
\end{itemize}

Note this test was not designed to perform a full verification of the
above requirements, but rather to demonstrate having reached a certain
level of partial capability during construction.


    \textbf{ Preconditions}:\\
    Test case LVV-T1334 must have already been executed and the prescribed
outputs saved, notably including the "LVV-T1334-output.csv" file.


    Execution status: {\bf Not Executed }

    Final comment:\\


    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      On the local computer, clone the test notebook for LDM-503-10a,
"LDM-503-10a-test.ipynb", into the user environment from the TBD tag of
the TBD Github repository. ~Note the SHA that applies to the version of
the test notebook that has been cloned.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Launch a LOCAL instance of JupyterLab (i.e., by running "jupyter lab")
on the computer to be used for testing. ~Ensure that the test notebook
is visible from within JupyterLab. ~\textbf{NB: as a reminder, this test
case must NOT be run in the Notebook Aspect.}

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Obtain an access token for the TAP service from the LSP instance under
test, by navigating to the
https://lsst-lsp-stable.ncsa.illinois.edu/auth/tokens endpoint in a web
browser and logging in. ~NCSA credentials for the tester should be
used.\\
Copy the access token to the clipboard.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      4 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Within the Posix shell session from which JupyterLab is to be launched,
set the environment variable "ACCESS\_TOKEN" to the value of the token
obtained in the previous step. To do this without exposing the token
unnecessarily, it is suggested to use the "read -s" command, pasting the
token in at the no-echo prompt this command produces.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      5 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Execute the entire notebook.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      6 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Record the success and/or failure indications that appear in the final
output cell of the notebook.\\
If the notebook execution produced an exception, record that.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      7 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Save and close the test notebook. ~Save the fully-executed notebook in
TBD location as a record of the test.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      8 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Copy the file "LVV-T1334-output.csv" that was saved in the output
repository for the LVV-T1334 test case into the home directory of the
JupyterLab session.

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      9 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      On the local computer, execute the command "pip install pyvo
jupyterlabutils" in the local environment. ~(It is suggested to do this
in a venv or conda environment.)

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      10 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Open the test notebook and insert the URL saved from the execution of
LVV-T1334, Step 9 into the input cell that reads\\
"portal\_job\_url = ''".

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Expected Result &

      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

    \end{longtable}


\input{appendix.tex}
\end{document}
